import sys, os ; sys.path.insert(0,os.path.dirname(os.path.dirname(__file__)))
from src.logs import Log ; log = Log()
import urllib3
import json

http = urllib3.PoolManager(cert_reqs='CERT_NONE')
urllib3.disable_warnings()

class Sgl():
    
    def __init__(self):
        #Initial configs
        environment = os.environ.get('ENVIRONMENT')
        app_environment = os.environ.get('APP_ENVIRONMENT')
        
        if environment == None or environment == 'pre':        
            self.url = 'https://sgl.paas.santanderbr.pre.corp/apiparametros/parametroController/IPA/ipa-app-rel-func-itsm/pre'

        if environment == 'pro' and app_environment == 'real': 
            self.url = 'https://sgl.paas.santanderbr.corp/apiparametros/parametroController/IPA/ipa-app-rel-func-itsm/pro-real' 

        if environment == 'pro' and app_environment == 'oculto': 
            self.url = 'https://sgl.paas.santanderbr.corp/apiparametros/parametroController/IPA/ipa-app-rel-func-itsm/pro-oculto'

    def get_sgl_parameter(self,parameter):
        try:
            headers = {'Content-Type': 'application/json'}
            r = http.request("GET",self.url, headers=headers,timeout=5)
            jresp = json.loads(r.data)
            jresp_2 = json.loads(jresp['valor'])
            jresp_3 = jresp_2[parameter]
            return str(jresp_3)
        except Exception as error:
            log.send_sgl_log(str(error),'Executando','Falha')
            return 'None'
